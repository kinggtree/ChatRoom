# 🗓 **项目开发日志**


## 🛠 **已知问题**
1. **验证问题**：项目基于`session`来验证权限，或许基于`cookie`的方法会更佳。
2. **更新显示问题**: 好友的新加入和删除无法触发页面和组件的刷新
3. **没有参数配置**: 以下参数无法简单配置：数据库名称，服务器端口
3. **安全性问题**: 未使用HTTPS（涉及到SSL根证书，暂时无法配置）

---

### 9.27 - 🛠 基础框架搭建
- **✅ 完成**
    - 搭建前端的基础框架
- **🚧 待解决**
    - 界面美观性尚待考虑
    - 消息部分未进行测试

---

### 10.6 - 📡 实现基础聊天功能
- **✅ 完成**
    - `session`验证
    - 数据库访问用户
    - 用户登录与登出功能
    - 消息发送（已存入数据库）
    - `wss`基础架构搭建
- **🚧 待解决**
    - WebSocket前端尚未调用
    - 研究WebSocket的使用方法和如何利用它实时显示消息

---

### 10.7 - 🎉 完成基本聊天功能
- **✅ 完成**
    - 成功实现最基础的聊天功能
    - 修改了很多API，使其更完善更正确
    - 学会了在mongoose查询中，使用async和await的方法
    - 实现了添加好友，注册用户的功能
    - 将密码储存转换为bcrypt方法
- **🚧 待解决**
    - 通讯录实时刷新问题
    - 消息刷新方式问题
    - 无法显示当前聊天对象

---

### 10.8 - 🚩 解决许多问题
- **✅ 完成**
    - 更改了API和前端处理message的方式
    - 实现了消息数据库更新后将更新的消息传入前端
    - 改用MongoDB副本集
- **🚧 待解决**
    - MongoDB副本集未经测试，还没有搭建

---

### 10.9 - 📻 完成消息实时接收
- **✅ 完成**
    - 成功搭建mongodb副本集(详情见txt文件)
    - 完成了消息的发送和实时接收（简单实现）
    - 优化了添加好友的布局
    - 我方添加好友后，对方无需再添加一次
    - 联系人列表在添加好友后更新
    - 新插入数据库的消息需要过滤（确认收件人和发件人）后发送


- **🚧 待解决**
    - 服务器客户端之间传输数据格式混乱

---

### 10.10 - 🎈 功能调整
- **✅ 完成**
    - 添加了一键启动和停止副本集的脚本

---

### 10.12 - 🎁 功能完善
- **✅ 完成**
    - 完成了个人主页面的功能
    - 重构了文件夹逻辑和主页面逻辑
    - 实现了头像功能
    - 实现了性别功能（和头像有联动）
    - 实现了修改个人简介功能
- **🚧 待解决**
    - 好友的新加入和删除无法触发页面和组件的刷新

---

### 10.13 - 🛠 继续完善功能，修复BUG
- **✅ 完成**
    - 修复了好友可以重复添加的问题
    - 对话框中可以显示聊天对象
    - 收到对方发来的新消息后可以更新
    - 服务器端口5000可以被访问，但是会返回404页面
    - 稍微优化了一下界面，实现了联系人列表的自动隐藏
    - 用crypto实现每小时生成随机字符串用于验权
    - 

- **🚧 待解决**
    - 部署貌似有问题
    - mongodb在云上貌似无法正常使用

---

### 10.14 🛫 成功部署
- **✅ 完成**
    - 成功部署到云服务器，并通过基础测试
    - 修改了 index.html 和 robots.txt ，以防止网站被爬虫爬到
    - 更新了网站参数，更换了网站图表，更改了网站名字
    - 添加了部分工具的配置指导文件
    - 在React和Experss中创建了全局变量，使修改API IP易如反掌
    - 回车可以发送消息，登录，以及添加好友了
    - 修复了删除好友后，对方联系人列表还存在自己的问题

- **🚧 待解决**
    - 在小屏幕下，ChatBox会出现渲染问题，具体表现在渲染后丢失 webkit-flex-basis: 100%，flex-basis: 100% 这两个属性（浏览器中），初步判断是因为对应的Grid的md未能正确调用

---

### 10.15 🎯 功能增加
- **✅ 完成**
    - 重构了聊天框代码逻辑
    - 加入了好友主页功能
    - 重构了个人主页
    - 登出完成二次确认
    - 更改个人信息可以更改更多了
    - 可以更改密码
    - 主界面UI修复
    - 管理联系人界面中的联系人排序功能

---

### 10.17 🎨 结构优化
- **✅ 完成**
    - 对底层的API和联系人相关组件进行了修改，使其适应“无contactUsername”的方式
    - 实现了修改用户名
    - 完成汉化
    - 调整布局

---

### 10.18 🌊 功能增加
- **✅ 完成**
    - 增加了手机端的消息红点提醒
    - 增加了点赞功能

---

### 10.22 💀 重构
- **✅ 完成**
    - 实现了未读消息数量显示
    - 利用Redux重构了应用，优化了状态管理
    - 利用SSE实现未读消息监听

- **🚧 待解决**
    - 前端无法关闭连接（后端的close不起作用）
        - 目前的解决方法是10分钟后强制关闭（暂时先这么办）
    - 未登录就访问界面不会自动跳转到登录界面
    - 新消息出现后，未能及时刷新消息通知
    - websocket sendNewMessage貌似会被重复调用多次

---

### 10.23 💃 BUG修复
- **✅ 完成**
    - 新消息出现后可以红点提醒了

---

### 10.25 💁‍♂️ 性能改善，逻辑优化
- **✅ 完成**
    - sendNewMessage不会被调用多次
    - 将所有React组件改为使用Redux，使得状态管理更自如
    - 实现了新消息发送时，对话框自动滚到底部
- **🚧 待解决**
    - 前端依旧无法关闭连接（详情见10.22）
    - 对方发送的新消息，无论用户是否已经将聊天框滚在最低端，其依旧会主动将聊天框滚下去

---

### 10.29 ✨ 添加功能
- **✅ 完成**
    - unreadContact状态重构，使得其有能够返回succeeded的状态
    - 群组功能列表添加完成
    - 群组功能可以正常使用
    - 聊天框滚动问题修复（一半）
    - 完成群成员的删除，群通知的添加和删除
- **🚧 待解决**
    - 客户端无法关闭SSE连接（见10.22日日志）
    - 群简介暂时无法修改

### 10.30 🏆 阶段性完成
- **✅ 完成**
    - 群简介可以修改
    - 群详情信息界面优化
    - 群信息编辑权限调整成功
    - 根据编译器的警告调整了未正确包含依赖数组的useEffect，并修复了 警告部分map()方法无返回值 的问题
- **🚧 待解决**
    - 客户端无法关闭SSE连接（见10.22日日志）